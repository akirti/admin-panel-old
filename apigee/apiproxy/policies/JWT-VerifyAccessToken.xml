<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<VerifyJWT async="false" continueOnError="false" enabled="true" name="JWT-VerifyAccessToken">
    <DisplayName>Verify JWT Access Token</DisplayName>
    <Properties/>
    <Algorithm>HS256</Algorithm>
    <Source>request.header.Authorization</Source>
    <IgnoreUnresolvedVariables>false</IgnoreUnresolvedVariables>
    <SecretKey>
        <Value ref="private.jwt.secret"/>
    </SecretKey>
    <Subject>access_token</Subject>
    <Issuer>easylife-auth</Issuer>
    <Audience>easylife-api</Audience>
    <AdditionalClaims>
        <Claim name="user_id" ref="jwt.user_id" type="string"/>
        <Claim name="email" ref="jwt.email" type="string"/>
        <Claim name="roles" ref="jwt.roles" type="string" array="true"/>
    </AdditionalClaims>
    <TimeAllowance>60s</TimeAllowance>
</VerifyJWT>
